```{r}
library(tidyverse)
library(FactoMineR)
library(kableExtra)
```

```{r}
mca_list <- readRDS("../mca/mca_obj/mca_list.obj")
ldf_mca <- mca_list$ldf_mca
mca0 <- mca_list$mca0
mca0_ja <- mca_list$mca0_ja
```

## 本章の目標
本章の目標は、仮説1に対する答えを提示することである。方法として、まず、保護者の教育意識に関する変数から、多重対応分析を用いて、空間を構築する。次に、構築された空間における軸を解釈し、保護者の教育意識が、どのような志向性によって形成されているか判断する。

## 分析方法
### 多重対応分析による養育空間の構築
多重対応分析とは、カテゴリカルデータに対する、幾何学的データ解析の手法である。幾何学的データ解析とは、「2元データ表における行要素と列要素を幾何学的な空間上に点として描く」\citep[2]{lerouxMultipleCorrespondenceAnalysis2010}ような分析手法である。具体的には、「個体×質問」のクロス表から、解答傾向の近さを示すよう、個体・(質問への)解答同士の距離を算出し、それぞれの個体・解答の位置を平面上に可視化する技法である\citep[7-11]{lerouxMultipleCorrespondenceAnalysis2010}。なお、多重対応分析において、平面を構成する軸はの本数は、すべての質問の選択肢を合計した数から、質問の数を引いた数である\citep[50]{lerouxMultipleCorrespondenceAnalysis2010}。そのため、作成できる平面の数は、軸の本数から1少ない数である。軸の重要度は分散率といい、空間全体の分散をどの程度説明したかという観点から表現される\citep[56]{lerouxMultipleCorrespondenceAnalysis2010}。分散率は第1軸が最大となり、順に小さくなる\citep[47]{lerouxMultipleCorrespondenceAnalysis2010}。分析には、R言語のパッケージである`FactoMineR`の`MCA()`関数を使用する。

## 変数
空間構築に使用する変数は、表\@ref(tab:mca0VarList)の通りである。本章で使用するデータは、「IEA国際数学・理科教育動向調査(TIMSS) 2015年調査」である。各変数は、小学4年生の子どもがいる、保護者への質問紙調査によって収集された。変数は、子どもに影響を与えるような、親の教育に対する考え方と行動を選択した。変数はそれぞれ、該当する場合は$1$を、そうでない場合は$0$をとる、ダミー変数である。6個のダミー変数から多重クロス表を作成するため、最終的には該当・非該当を合わせた12個のラベルによって、空間の構築を行う。該当ラベルには"_1"を、非該当ラベルには"_0"を、末尾に付ける。

### 各変数の詳細
すべて$0$または$1$の2値を取るダミー変数である。

#### 知育高頻度
読み聞かせなど就学前の知育に関する16項目の質問について、「ほとんど，あるいは，まったくしなかった」を0点、「ときどきした」を1点、「よくした」を2点としてカウント(合計32点)する\citep[15.30]{martinCreatingInterpretingTIMSS2016}。24点相当以上の場合$1$を、24点相当未満の場合$0$をとる。

#### 通塾高成績
「この12か月の間で，あなたのお子さんは，次の教科について学校外で提供される学習指導や個別指導を受けたことがありますか」という質問に対し、「はい， 学級で優秀な成績を収めるために受けた」と答えた場合に$1$を、「はい，勉強についていくために受けた」「いいえ」と答えた場合および無回答の場合に$0$をとる。

#### 理数好意的
人生や社会に対して、数学や科学が重要であるか、というテーマに関する8項目の質問について、「強くそう思う」を2点、「そう思う」を1点、「そう思わない」「まったくそう思わない」を0点としてカウント(合計16点)する\citep[15.30]{martinCreatingInterpretingTIMSS2016}。12点相当以上の場合$1$を、12点相当未満の場合は$0$をとる。

#### 読書親週6時間以上
「通常，1週間のうち、家であなた自身の読書にあなたはどの程度の時間を割いていますか。なお，読書には，本や雑誌，新聞，仕事用の資料(印刷されたものまたはデジタルメディア)を含みます。」という質問に対し、「1週間に10時間より多い」「1週間に6〜10時間」と答えた場合は$1$を、「1週間に1〜5時間」「1週間に1時間未満」と答えた場合および無回答の場合は$0$をとる。

#### 本親26冊以上
「あなたの家には，およそどのくらい本がありますか。(電子書籍や雑誌，新聞，子供向けの本は含みません。)」という質問に対し、「200冊より多い」「101〜200冊」「26〜100冊」と答えた場合は$1$を、「11〜25冊」「0〜10冊」と答えた場合および無回答の場合は$0$をとる。

#### 大卒以上期待
「お子さんの教育について，あなたはお子さんに，どこまでの進学を期待しますか。」という質問に対し、「大学院まで」「大学まで」と答えた場合は$1$を、「短期大学，高等専門学校(高専)，専門学校(専修学校専門課程)まで」「高等学校の専攻科まで」「高等学校まで」「中学校まで」と答えた場合および無回答の場合は$0$をとる。


\clearpage

```{r mca0VarList}
ldf_mca %>%
    dplyr::rename(!!!mca_list$named_mca0_ja_vars) %>%
    modelsummary::datasummary_skim(type = "categorical", title = "空間構築に使用する変数一覧(重み付きなし)", output = "kableExtra") %>%
    kableExtra::kable_styling()
```


## 分析結果
分析結果のプロットを、図\@ref(fig:mca0JaFmVar)に示す。

```{r mca0JaFmVar, fig.cap="保護者の教育意識空間"}
mca0_ja %>% FactoMineR::plot.MCA(invisible = "ind", title = "")
```

### 軸の解釈
第1軸の右側には、各ダミー変数が1であることを示すラベルが並び、反対の左側には0であることを示すラベルが並ぶ。よって、第1軸は、教育意識の「高低」を示すと考えられる。次に、第2軸は、「知育高頻度」「読書親週6時間以上」「本親25冊以上」変数と、「通塾高成績」「理数好意的」「大卒以上期待」変数が対をなしており、教育意識の構成を示す軸であると考えられる。前者の解釈について、直接名前を付けることは難しいが、家庭内での教育活動を重視した群であるとみられる。一方、後者については、業績達成や学歴達成を志向した変数が含まれており、業績達成志向と解釈するのが妥当であると考える。仮説での定義のように、前者を普遍性志向、後者を希少性志向とみなすことは、可能であると考える。

### 空間の評価
```{r eig}
data.frame(分散率 = mca0$eig[,2]) %>%
    knitr::kable(caption = "各軸の分散率(単位:％)")
```

各軸の分散率を、表\@ref(tab:eig)に示す。第1軸の分散率は`r mca0$eig[1,2] %>% round(2)`%、第2軸の分散率は`r mca0$eig[2,2] %>% round(2)`%である。もっとも、第2軸までで説明できるのは、全分散の`r mca0$eig[3,2] %>% round(2)`%程度である。今回の分析では、第6軸まで分散率が算出されるが、第1軸を除き、分散率はどの軸もほぼ似たような値を示す。変数は6個使用しているため、それぞれの変数が独自の軸を形成していると考えられる。よって、構築された空間では、教育意識の総量と構成に関する表現は達成した。しかし、総量と構成の2軸のみで、教育意識の大部分を説明することは、困難であった。

### ラベルの寄与率
```{r contribVar}
mca0_ja$var$contrib %>%
    data.frame() %>%
    knitr::kable(caption = "各ラベルの軸に対する寄与率(単位:％)")
```

各ラベルの軸に対する寄与率を、表\@ref(tab:contribVar)に示す。各軸において、寄与率が大きいラベルほど、軸の両極に配置される。

## クラスター分析
最後に、個体(本章の場合は各家庭)の座標を元に、クラスター分析を行い、教育意識において類似度の高いグループを作成する。最低の分岐回数は4回とし、ユークリッド距離・ウォード法にて行う。分析には、`FactoMineR`パッケージの`HCPC()`関数を使用する。

```{r clusterMap, fig.cap="クラスター分析による個体の分類"}
mca_list$hcpc0 %>%
    FactoMineR::plot.HCPC(choice = "map", draw.tree = FALSE, ind.names = FALSE, centers.plot = TRUE, title = "")
```

図\@ref(fig:clusterMap)が、クラスター分析による分類別の、個体の配置である。おおむね、クラスタ1が第1軸の左側、クラスタ4が第2軸の右側に配置され、その間にクラスタ2とクラスタ3が挟まれている。また、クラスタ2は第2軸の下側に、クラスタ3は第2軸の上側に分布している。このことから、クラスタ4は希少性志向と普遍性志向の双方を、クラスタ2は希少性志向を、クラスタ3は普遍性志向を持つグループであり、クラスタ1は双方ともあまり持たないグループであると考えられる。

## 小括
本章では、保護者の教育意識に関する空間の構築と、そこから読み取れる教育意識の志向性について、分析を行った。結果、保護者の教育意識空間は、第1軸が教育意識の高低、第2軸が教育意識の構成を表現することが明らかになった。しかし、空間の構築に使用した変数が、それぞれ独自の軸を形成する傾向にあることから、第1軸と第2軸のみで、空間の変動について、大半を説明することは困難であった。第2軸について、両極を解釈すると、一方は子どもの業績達成を志向したものであり、もう一方は家庭内での知的な伝達に関するものであった。前者を希少性志向、後者を普遍性志向とみなし、次章では学力格差の原因としての教育意識について、より詳細に分析する。
